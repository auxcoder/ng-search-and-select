!function(u){function e(o,c,r){var s,d=this,e=new function(){function t(e){var n="option-list-item-"+d.keyboardFocusIndex,t=e?1:-1,o="option-list-item-"+(d.keyboardFocusIndex+t),i=r[0].getElementById("option-list"),s=r[0].getElementById(n),l=r[0].getElementById(o)||s;l.offsetTop>=i.offsetHeight+i.scrollTop&&(i.scrollTop=l.offsetTop-i.offsetHeight+l.offsetHeight),i.scrollTop>l.offsetTop&&(i.scrollTop=l.offsetTop)}this.run=function(e){if(!1!==i){var n=e.keyCode?e.keyCode:e.which;i=!1,38===n&&0!==d.keyboardFocusIndex&&null!==d.keyboardFocusIndex&&(d.keyboardFocusIndex-=1,t(!1)),40===n&&function(){if(null===d.keyboardFocusIndex)return t(!(d.keyboardFocusIndex=0)),o.$apply();d.keyboardFocusIndex>=d.filteredOptions.length-1||(d.keyboardFocusIndex+=1,t(!0))}(),13===n&&function(e){null!==d.keyboardFocusIndex&&(a(d.filteredOptions[d.keyboardFocusIndex]),e.target.blur(),i=!0)}(e),27===n&&function(e){e.target.blur(),i=!0}(e),o.$apply()}}},i=!0;function t(e){null!==d.ngModel&&d.ngModel.$modelValue&&d.ngModel.$modelValue[d.idKey]===d.options[e][d.idKey]&&(d.selectedIndex=e)}function l(e){for(var n=d.options[e],t="",o=0;o<s.length;o++){var i=s[o];u.isDefined(n[i])&&(t+=n[i]+" ")}if(""===t)throw"Error: No option attribute matched with any key in labelFromKeys.";t=t.slice(0,-1),d.options[e].ss_display_name=t,d.options[e].ss_display_html=c(t)}function a(e){d.selectedIndex=e.ss_index,d.ngModel.$setViewValue(e),function(e){d.ngModel.$setViewValue(e)}(e),p()}function p(){d.searching=!1,null!==d.selectedIndex?u.isUndefined(d.options[d.selectedIndex])||(d.searchString=d.options[d.selectedIndex].ss_display_name):d.searchString=""}function n(){if(""===d.searchString||u.isUndefined(d.searchString))d.filteredOptions=d.options;else{for(var e=[],n=this.searchString.toLowerCase(),t=0;t<d.options.length;t++){var o=d.options[t].ss_display_name.toLowerCase().indexOf(n);if(-1!==o){var i=u.copy(d.options[t]),s=i.ss_display_name.substring(0,o),l=i.ss_display_name.substring(o,o+n.length),r=i.ss_display_name.substring(o+n.length);i.ss_display_html=(void 0,c(s+('<span class="search-bold">'+l+"</span>")+r)),e.push(i)}}d.filteredOptions=e}}d.$onInit=function(){s=d.labelFromKeys.split(" "),d.inputName=Date.now(),d.icon=d.selectIcon},d.$onChanges=function(e){e.hasOwnProperty("options")&&u.isDefined(e.options.currentValue)&&!e.options.isFirstChange()&&function(){if(u.isUndefined(d.ngModel))return;d.disabled=u.copy(0===d.options.length),function(){if(u.isDefined(d.idKey)&&!d.options[0].hasOwnProperty(d.idKey))throw"Error: No option attribute matched with specified idKey: "+d.idKey}(),u.isUndefined(d.idKey)&&(d.idKey="id");for(var e=0;e<d.options.length;e++)n=e,d.options[n].ss_index=n,t(e),l(e);var n;d.filteredOptions=d.options,p()}()},o.$watch(function(){return d.ngModel.$viewValue},function(e){e&&e.ss_display_name&&a(e)},!0),d.filteredOptions={},d.keyboardFocusIndex=null,d.searching=!1,d.searchString="",d.selectedIndex=null,d.isOptionSelected=function(){return Boolean(u.isObject(d.ngModel.$viewValue)&&0!==Object.keys(d.ngModel.$viewValue).length)},d.searchOptions=n,d.selectOption=a,d.ssBlur=function(){d.keyboardFocusIndex=null,u.element(document).off("keydown",e.run),u.element(document).off("keyup",function(){i=!0}),p()},d.ssFocus=function(){r.on("keydown",e.run),r.on("keyup",function(){i=!0}),d.searching=!0,d.searchString="",n()}}e.$inject=["$scope","$sanitize","$document"],u.module("ngSearchAndSelect.config",[]).value("ngSearchAndSelect.config",{debug:!0}),u.module("ngSearchAndSelect.component",[]).component("searchAndSelect",{require:{ngModel:"ngModel"},bindings:{options:"<",disabled:"<?",required:"<?",idKey:"@",labelFromKeys:"@",placeholderText:"@",selectIcon:"@"},templateUrl:"/ng-search-and-select/search-and-select.html",controller:e}),u.module("ngSearchAndSelect",["ngSearchAndSelect.config","ngSearchAndSelect.component","ngSanitize"])}(angular),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ngSearchAndSelect"),angular.module("ngSearchAndSelect.component").run(function(){angular.element(document).find("head").prepend('<style type="text/css">.ss-container{position:relative;font-weight:400}.ss-container .disabled{opacity:0.5}.ss-container .ss-input-container{position:relative}.ss-container .ss-input-container .ss-input{height:44px}.ss-container .ss-input-container .icon-base{position:absolute;z-index:3;top:calc(50%);right:10px;font-size:28px;pointer-events:none}.ss-container .results-container{width:100%;position:absolute;z-index:200;top:100%}.ss-container .results-container .option-list{height:auto;width:100%;max-height:300px;padding:0px;margin:0px;color:inherit;background-color:white;border:1px solid #ccc;border-top:none;box-shadow:0px 1px 3px 0.5px #bbb;list-style:none;overflow:auto}.ss-container .results-container .option-list .option-list-item{padding:5px 15px 5px 15px;cursor:pointer}.ss-container .results-container .option-list .option-list-item.kb-focused{background-color:silver}.ss-container .results-container .option-list .option-list-item:hover{background-color:#b8b8b8}.ss-container .results-container .option-list .option-list-item .search-bold{font-weight:bold}</style>')}),angular.module("ngSearchAndSelect.component").run(["$templateCache",function(e){e.put("/ng-search-and-select/search-and-select.html",'<div class="search-select-container" ng-class="{\'disabled\': $ctrl.disabled}">\n\t<div class="ss-input-container form-group" ng-class="{\'container-expanded\': $ctrl.isOptionSelected()}">\n\t\t<label class="control-label" ng-class="{\'cover-expanded\': $ctrl.isOptionSelected()}">\n\t\t\t{{ $ctrl.placeholderText }}\n\t\t</label>\n\n\t\t<input name="search_string{{ $ctrl.inputName }}" type="text" class="form-control" placeholder="{{ $ctrl.placeholderText }}" autocomplete="off" ng-class="{\'input-expanded\': $ctrl.isOptionSelected()}" ng-model="$ctrl.searchString" ng-focus="$ctrl.ssFocus()" ng-keyup="$ctrl.searchOptions()" ng-blur="$ctrl.ssBlur()" ng-disabled="$ctrl.disabled" ng-required="$ctrl.required">\n\t\t<i class="icon-base" ng-class="{\'icon-expanded\': $ctrl.isOptionSelected(), \'{{\n\t\t\t\t$ctrl.icon\n\t\t\t}}\': true}"></i>\n\t</div>\n\n\t<div class="results-container" ng-show="$ctrl.searching">\n\t\t<ul id="option-list" class="option-list" ng-show="$ctrl.filteredOptions.length > 0">\n\t\t\t<li id="option-list-item-{{ $index }}" class="option-list-item" ng-class="{\'kb-focused\': $ctrl.keyboardFocusIndex === $index}" ng-repeat="option in $ctrl.filteredOptions track by $index" ng-mousedown="$ctrl.selectOption(option)" ng-bind-html="option.ss_display_html"></li>\n\t\t</ul>\n\t</div>\n</div>\n')}]);