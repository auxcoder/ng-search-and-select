!function(u){function e(o,r,c){var s,a=this,e=new function(){function t(e){var n="option-list-item-"+a.keyboardFocusIndex,t=e?1:-1,o="option-list-item-"+(a.keyboardFocusIndex+t),i=c[0].getElementById("option-list"),s=c[0].getElementById(n),l=c[0].getElementById(o)||s;l.offsetTop>=i.offsetHeight+i.scrollTop&&(i.scrollTop=l.offsetTop-i.offsetHeight+l.offsetHeight),i.scrollTop>l.offsetTop&&(i.scrollTop=l.offsetTop)}this.run=function(e){if(!1!==i){var n=e.keyCode?e.keyCode:e.which;i=!1,38===n&&0!==a.keyboardFocusIndex&&null!==a.keyboardFocusIndex&&(a.keyboardFocusIndex-=1,t(!1)),40===n&&function(){if(null===a.keyboardFocusIndex)return t(!(a.keyboardFocusIndex=0)),o.$apply();a.keyboardFocusIndex>=a.filteredOptions.length-1||(a.keyboardFocusIndex+=1,t(!0))}(),13===n&&function(e){null!==a.keyboardFocusIndex&&(d(a.filteredOptions[a.keyboardFocusIndex]),e.target.blur(),i=!0)}(e),27===n&&function(e){e.target.blur(),i=!0}(e),o.$apply()}}},i=!0;function t(e){null!==a.ngModel&&a.ngModel.$modelValue&&a.ngModel.$modelValue[a.idKey]===a.options[e][a.idKey]&&(a.selectedIndex=e)}function l(e){for(var n=a.options[e],t="",o=0;o<s.length;o++){var i=s[o];u.isDefined(n[i])&&(t+=n[i]+" ")}if(""===t)throw"Error: No option attribute matched with any key in labelFromKeys.";t=t.slice(0,-1),a.options[e].ss_display_name=t,a.options[e].ss_display_html=r(t)}function d(e){a.selectedIndex=e.ss_index,a.ngModel.$setViewValue(e),function(e){a.ngModel.$setViewValue(e)}(e),p()}function p(){a.searching=!1,null!==a.selectedIndex?u.isUndefined(a.options[a.selectedIndex])||(a.searchString=a.options[a.selectedIndex].ss_display_name):a.searchString=""}function n(){if(""===a.searchString||u.isUndefined(a.searchString))a.filteredOptions=a.options;else{for(var e=[],n=this.searchString.toLowerCase(),t=0;t<a.options.length;t++){var o=a.options[t].ss_display_name.toLowerCase().indexOf(n);if(-1!==o){var i=u.copy(a.options[t]),s=i.ss_display_name.substring(0,o),l=i.ss_display_name.substring(o,o+n.length),c=i.ss_display_name.substring(o+n.length);i.ss_display_html=(void 0,r(s+('<span class="search-bold">'+l+"</span>")+c)),e.push(i)}}a.filteredOptions=e}}a.$onInit=function(){s=a.labelFromKeys.split(" "),a.inputName=Date.now(),a.ngModel.$formatters.push(function(e){return u.isDefined(e)?e:""}),a.ngModel.$parsers.push(function(e){return e})},a.$onChanges=function(e){e.hasOwnProperty("options")&&u.isDefined(e.options.currentValue)&&!e.options.isFirstChange()&&function(){if(u.isUndefined(a.ngModel))return;a.disabled=u.copy(0===a.options.length),function(){if(u.isDefined(a.idKey)&&!a.options[0].hasOwnProperty(a.idKey))throw"Error: No option attribute matched with specified idKey: "+a.idKey}(),u.isUndefined(a.idKey)&&(a.idKey="id");for(var e=0;e<a.options.length;e++)n=e,a.options[n].ss_index=n,t(e),l(e);var n;a.filteredOptions=a.options,p()}()},o.$watch(function(){return a.ngModel.$viewValue},function(e){e&&e.ss_display_name&&d(e)},!0),a.filteredOptions={},a.keyboardFocusIndex=null,a.searching=!1,a.searchString="",a.selectedIndex=null,a.isOptionSelected=function(){return Boolean(u.isObject(a.ngModel.$viewValue)&&0!==Object.keys(a.ngModel.$viewValue).length)},a.searchOptions=n,a.selectOption=d,a.ssBlur=function(){a.keyboardFocusIndex=null,u.element(document).off("keydown",e.run),u.element(document).off("keyup",function(){i=!0}),p()},a.ssFocus=function(){c.on("keydown",e.run),c.on("keyup",function(){i=!0}),a.searching=!0,a.searchString="",n()}}e.$inject=["$scope","$sanitize","$document"],u.module("ngSearchAndSelect.config",[]).value("ngSearchAndSelect.config",{debug:!0}),u.module("ngSearchAndSelect.component",[]).component("searchAndSelect",{require:{ngModel:"ngModel"},bindings:{options:"<",disabled:"<?",required:"<?",idKey:"@",labelFromKeys:"@",placeholderText:"@",fontAwesomeIcon:"@"},templateUrl:"/ng-search-and-select/search-and-select.html",controller:e}),u.module("ngSearchAndSelect",["ngSearchAndSelect.config","ngSearchAndSelect.component","ngSanitize"])}(angular),angular.module("ngSearchAndSelect.component").run(function(){angular.element(document).find("head").prepend('<style type="text/css">.search-select-container{position:relative;font-weight:400}.search-select-container .disabled{opacity:0.5}.search-select-container div,.search-select-container ul,.search-select-container li,.search-select-container i{display:block}.search-select-container .ss-input-container{position:relative}.search-select-container .ss-input-container .form-control{height:44px}.search-select-container .ss-input-container .icon-base{position:absolute;z-index:3;top:calc(45%);right:10px;font-size:28px;pointer-events:none}.search-select-container .results-container{width:100%;position:absolute;z-index:200;top:100%}.search-select-container .results-container .option-list{height:auto;width:100%;max-height:300px;padding:0px;margin:0px;color:inherit;background-color:white;border:1px solid #ccc;border-top:none;box-shadow:0px 1px 3px 0.5px #bbb;list-style:none;overflow:auto}.search-select-container .results-container .option-list .option-list-item{padding:5px 15px 5px 15px;cursor:pointer}.search-select-container .results-container .option-list .option-list-item.kb-focused{background-color:silver}.search-select-container .results-container .option-list .option-list-item:hover{background-color:#b8b8b8}.search-select-container .results-container .option-list .option-list-item .search-bold{font-weight:bold}</style>')}),angular.module("ngSearchAndSelect.component").run(["$templateCache",function(e){e.put("/ng-search-and-select/search-and-select.html",'<div class="search-select-container" ng-class="{\'disabled\': $ctrl.disabled}">\n\t<div class="ss-input-container form-group" ng-class="{\'container-expanded\': $ctrl.isOptionSelected()}">\n\t\t<label class="control-label" ng-class="{\'cover-expanded\': $ctrl.isOptionSelected()}">\n\t\t\t{{ $ctrl.placeholderText }}\n\t\t</label>\n\n\t\t<input name="search_string{{ $ctrl.inputName }}" type="text" class="form-control" placeholder="{{ $ctrl.placeholderText }}" autocomplete="off" ng-class="{\'input-expanded\': $ctrl.isOptionSelected()}" ng-model="$ctrl.searchString" ng-focus="$ctrl.ssFocus()" ng-keyup="$ctrl.searchOptions()" ng-blur="$ctrl.ssBlur()" ng-disabled="$ctrl.disabled" ng-required="$ctrl.required">\n\t\t<i class="icon-base fa" ng-class="{\'icon-expanded\': $ctrl.isOptionSelected(), \'{{\n\t\t\t\t$ctrl.fontAwesomeIcon\n\t\t\t}}\': true}"></i>\n\t</div>\n\n\t<div class="results-container" ng-show="$ctrl.searching">\n\t\t<ul id="option-list" class="option-list" ng-show="$ctrl.filteredOptions.length > 0">\n\t\t\t<li id="option-list-item-{{ $index }}" class="option-list-item" ng-class="{\'kb-focused\': $ctrl.keyboardFocusIndex === $index}" ng-repeat="option in $ctrl.filteredOptions track by $index" ng-mousedown="$ctrl.selectOption(option)" ng-bind-html="option.ss_display_html"></li>\n\t\t</ul>\n\t</div>\n</div>\n')}]);